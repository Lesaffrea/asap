 - XML extracted without id redundancy filter.

D1:
uniprot:(keyword:"Cleavage on pair of basic residues [KW-0165]" annotation:(type:propep evidence:manual) annotation:(type:signal evidence:any) annotation:(type:peptide)) AND identity:0.5
http://www.uniprot.org/uniref/?query=uniprot%3A%28keyword%3A%22Cleavage+on+pair+of+basic+residues+%5BKW-0165%5D%22+annotation%3A%28type%3Apropep+evidence%3Amanual%29+annotation%3A%28type%3Asignal+evidence%3Aany%29+annotation%3A%28type%3Apeptide%29%29+AND+identity%3A0.5&sort=score
346 seqs at 0.5 ID. 676 seqs at 0.9 ID.

    FILTER:
    http://weizhong-lab.ucsd.edu/cdhit_suite/cgi-bin/result.cgi?JOBID=1438941055
    D1_NotInNeuroPred.fasta =
    Sequences in D1 not "found" in NeuroPred. 232.



D2:
uniprot:(keyword:"Cleavage on pair of basic residues [KW-0165]" annotation:(type:propep evidence:experimental) annotation:(type:peptide evidence:any)) AND identity:0.9
141 seqs


    FILTER:
    http://weizhong-lab.ucsd.edu/cdhit_suite/cgi-bin/result.cgi?JOBID=1438951526
    D2_NotInNeuroPred.fasta =
    Sequences in D2 not "found" in NeuroPred. 110.

-------------------------


D3:

keyword:"Cleavage on pair of basic residues [KW-0165]" annotation:(type:propep evidence:manual) annotation:(type:peptide) length:[12 TO 800] NOT taxonomy:"Vir [1288776]" NOT annotation:(type:non_std evidence:any) NOT annotation:(type:non_cons) NOT annotation:(type:transmem) NOT annotation:(type:intramem)

http://www.uniprot.org/uniprot/?query=keyword%3A%22Cleavage+on+pair+of+basic+residues+%5BKW-0165%5D%22+annotation%3A%28type%3Apropep+evidence%3Amanual%29+annotation%3A%28type%3Apeptide%29+length%3A%5B12+TO+800%5D+NOT+taxonomy%3A%22Vir+%5B1288776%5D%22+NOT+annotation%3A%28type%3Anon_std+evidence%3Aany%29+NOT+annotation%3A%28type%3Anon_cons%29+NOT+annotation%3A%28type%3Atransmem%29+NOT+annotation%3A%28type%3Aintramem%29&sort=score

Note that many toxins appear! (Also, the length cutoff is important due to various very long viral polyproteins). (adding the "secreted" keyword criteria would remove only ~7 proteins from this)

    -> 894 sequences (pre filtering).

    FILTER:
    i)    "raw" sequences filtered internally (3 runs to 70% ID, minimum 10% length overlap):
        http://weizhong-lab.ucsd.edu/cdhit_suite/cgi-bin/result.cgi?JOBID=1442223776
        -> 437 sequences ("D3_all_70ID.fasta")

    ii)    Then filtered for max 40% ID similarity with the train set ("NeuroPred-UniqueNNames-sequences-65ID.fasta" - 238 sequences).
        http://weizhong-lab.ucsd.edu/cdhit_suite/cgi-bin/result.cgi?JOBID=1442224683
        ("Sequences in db2 that are not matched to db1"):
        ->  316 sequences ("D3_TEST.fasta")

    iii)
    Internal Clustering with CD-HIT (train vs train only) to 50%  gives:
    http://weizhongli-lab.org/cdhit_suite/cgi-bin/result.cgi?JOBID=1442240233
    183 sequences. ("D3_TEST_50.fasta")

    iv)
    While I ran SCRATCH's ProfilePRO to generate PSSMs, (3 runs), errors occured.
    I split the files many times to track it down [and played with sequence filtering]. It's due to ("REP1_USTMA Q99109"), which has a "/" in it's descriptor-name. (This sequence was removed).
    I merged the resulting split files. [_A,B,C1,C22,C231 {contained the removal},C3 ]
        The ORDER of Fastas and PSSMs may be DIFFERENT After this!!

        >  174, ("D3_TEST_50_FILT.fasta")
        PSSMs were manually merged (A,B,C1,C22,C231,C3) into "D3_TEST_50_FILT.pssm"


    To get DISOrder preds:
        I manually changed all the fasta names, replacing "|" with "--". I run DisoPred (using "GetDiso.py") on this. I will then rename the sequences to their original name.
---------------
RERUN! D3

I EXTRACTED the Fastas from the D3 XML. (Otherwise - names are no good). (These fastas are with the SignalPeptide removed)

I Then filter the fastas anew.

    i) filter Test-seqs internally - using usearch.
        usearch -cluster_fast annotated_seqs.fasta -id 0.65 -centroids annotated_seqs.fasta
        886 -> 460 sequences.   (Most are singletons).  "D3.fasta"

    ii)    Then filtered for max 40% ID similarity  with the data/Neuropred training set  - 238 sequences).
        http://weizhong-lab.ucsd.edu/cdhit_suite/cgi-bin/result.cgi?JOBID=1442743762
        ("Sequences in db2 that are not matched to db1"):
        ->  327 sequences ("annotated_seqs.fasta")

    iii) Extract external features for the test data.  (I'm not doing another filter of it).
    SCRATCH 1.0 was used. (I couldn't install 1.1 remotely. wget file size error).


    iv)    seq: Q3YEF9,Q9BP90 - X was removed from the LF sequence manually (It was already removed from the fasta). (There is a BUG with length mismatches - X are removed from fasta but not LF - should be fixed).
    For now - I "fixed" the lf by hand.

    v) Extracted features. Used the following feature_key:
            FEATURE_KEY_OPTIONS = [
            'position', # Features related to the position of the window within the whole protein
            'basic_properties', # TODO
            'scales', # TODO
            'cysteine_motifs', # TODO
            'fid_disorder', # TODO
            'kr_motifs', # TODO (Mention that it's relevant only for cleavage prediction)
            'charge', # The charge (+1, -1 or 0) of each residue along the window
            'accum_charge_left', # Accumulating charge from the left of the window
            # 'accum_charge_right', # Accumulating charge from the right of the window
            'accum_pos_charge_left', # Accumulating charge from the left of the window where only positive amino-acids (K and R) are considered
            # 'accum_pos_charge_right', # Accumulating charge from the right of the window where only positive amino-acids (K and R) are considered

            # 'aa', # the actual amino-acid at each position given by one-hot encoding
            'aa_reduced', # Same as 'aa', after using a reduced alphabet of 15 amino-acids
            'aa_context_count', # Counting the number of occurrences of each amino-acid in the part of the protein to the left/right of the window
            # 'aa_counts', # Counting the number of occurrences of each amino-acid in the window

            'ss', # The given secondary-structure prediction at each position in the window given by one-hot encoding
            'ss_context_count', # Like 'aa_context_count', only for ss instead of aa
            'ss_segment', # TODO
            'acc', # The given accessibility prediction at each position in the window given by one-hot encoding
            'acc_context_count', # Like 'aa_context_count', only for acc instead of aa
            'acc_segment', # TODO
            'disorder', # The given disorder prediction at each position in the window given by one-hot encoding
            'disorder_context_count', # Like 'aa_context_count', only for disorder instead of aa
            'disorder_segment', # TODO
            'pssm', # AA Frequency from the PSSM at each position in the window
            'pssm_entropy', # Entropy of the PSSM at each position
        ]

